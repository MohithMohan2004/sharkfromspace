<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shark Tracker</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { width: 100%; height: 100%; overflow-x: hidden; }
body { 
    font-family: 'Poppins', sans-serif; 
    color: #fff; 
    min-height: 100vh; 
    background: url('https://imgsonica.s3.amazonaws.com/wp-content/uploads/2025/05/77355.jpg') no-repeat center center fixed; 
    background-size: cover; 
    position: relative; 
    padding-top: 70px;
}
body::before {
    content: ""; 
    position: fixed; 
    top:0; left:0; 
    width:100%; height:100%; 
    background: rgba(0,0,0,0.4); 
    z-index:-1;
}

/* Scrollbar */
::-webkit-scrollbar { width:8px; }
::-webkit-scrollbar-track { background:transparent; }
::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius:10px; }
::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.4); }

/* Navigation bar */
nav { 
    position: fixed; top:0; left:0; width:100%; 
    background: transparent; 
    display:flex; justify-content:flex-end; align-items:center; 
    padding:1rem 2rem; z-index:100; 
}
nav a { color:#00eaff; text-decoration:none; font-weight:600; margin-left:1.5rem; transition:0.3s; }
nav a:hover { color:#fff; text-decoration:underline; }

/* Hamburger menu */
#menu-toggle { display:flex; align-items:center; gap:10px; background:none; border:none; cursor:pointer; z-index:101; margin-right:auto; }
#menu-toggle .hamburger { display:flex; flex-direction:column; justify-content:space-between; width:25px; height:20px; }
#menu-toggle .hamburger span { display:block; height:3px; width:100%; background:#00eaff; border-radius:2px; transition: all 0.3s ease; }
#menu-toggle.active .hamburger span:nth-child(1) { transform: rotate(45deg) translate(5px,5px); }
#menu-toggle.active .hamburger span:nth-child(2) { opacity: 0; }
#menu-toggle.active .hamburger span:nth-child(3) { transform: rotate(-45deg) translate(6px,-6px); }
#menu-toggle .menu-text { font-weight:600; color:#00eaff; font-size:1rem; }

/* Sidebar */
.sidebar-menu {
    position: fixed; top:0; left:-250px; width:220px; height:100%; 
    background: rgba(0,50,100,0.6); backdrop-filter: blur(10px); 
    padding:3rem 1rem; display:flex; flex-direction:column; gap:1rem; 
    border-radius:0 20px 20px 0; transition:left 0.3s ease; z-index:99;
}
.sidebar-menu.show { left:0; }
.sidebar-menu a {
    padding:0.8rem 1rem; text-align:center; border-radius:15px; 
    color:#fff; font-weight:600; background: linear-gradient(135deg,#0072ff,#00c6ff);
    text-decoration:none; box-shadow:0 5px 10px rgba(0,0,0,0.3); transition: all 0.3s ease;
}
.sidebar-menu a:hover {
    transform:translateY(-3px); background:linear-gradient(135deg,#00c6ff,#0072ff);
    box-shadow:0 8px 15px rgba(0,0,0,0.5);
}

/* Main content */
.main-content { flex:1; padding:6rem 2rem 3rem 2rem; z-index:1; position:relative; max-width:1000px; margin:auto; }
header { height:30vh; display:flex; align-items:center; justify-content:center; text-align:center; margin-bottom:2rem; }
header h1 { font-size:3rem; margin-bottom:1rem; color:#00eaff; text-shadow:2px 2px 6px rgba(0,0,0,0.6); }
header p { font-size:1.2rem; line-height:1.6; color:#f0f0f0; text-shadow:1px 1px 4px rgba(0,0,0,0.4); }

.content-container { 
    background: rgba(0,105,148,0.3); 
    padding:2.5rem; 
    border-radius:20px; 
    box-shadow:0 10px 25px rgba(0,0,0,0.5); 
    backdrop-filter: blur(8px); 
    margin-bottom:2rem; 
}

/* Control Panel */
.control-panel {
    background: rgba(0,0,0,0.6);
    padding: 2rem;
    border-radius: 15px;
    margin-bottom: 2rem;
}

.control-panel h2 {
    color: #00eaff;
    margin-bottom: 1.5rem;
    text-align: center;
}

.parameter-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
}

.parameter-group {
    display: flex;
    flex-direction: column;
}

.parameter-group label {
    color: #e0f7ff;
    margin-bottom: 0.5rem;
    font-weight: 600;
}

.parameter-group input {
    padding: 0.8rem;
    border: 2px solid rgba(0,234,255,0.3);
    border-radius: 8px;
    background: rgba(0,0,0,0.4);
    color: #fff;
    font-size: 1rem;
}

.parameter-group input:focus {
    outline: none;
    border-color: #00eaff;
    box-shadow: 0 0 10px rgba(0,234,255,0.3);
}

/* Buttons */
.button-group {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
}

.btn {
    padding: 1rem 2rem;
    border: none;
    border-radius: 10px;
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.btn-primary {
    background: linear-gradient(135deg, #0072ff, #00c6ff);
    color: white;
    box-shadow: 0 5px 15px rgba(0,114,255,0.4);
}

.btn-primary:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0,114,255,0.6);
}

.btn-secondary {
    background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
    color: white;
    box-shadow: 0 5px 15px rgba(255,107,107,0.4);
}

.btn-secondary:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(255,107,107,0.6);
}

.btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none !important;
}

/* Status and Results */
.status-container {
    background: rgba(0,0,0,0.6);
    padding: 1.5rem;
    border-radius: 15px;
    margin-bottom: 2rem;
    min-height: 100px;
}

.status-container h3 {
    color: #00eaff;
    margin-bottom: 1rem;
}

.status-message {
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1rem;
    font-weight: 600;
}

.status-success {
    background: rgba(0,255,0,0.2);
    border: 2px solid rgba(0,255,0,0.5);
    color: #90ff90;
}

.status-error {
    background: rgba(255,0,0,0.2);
    border: 2px solid rgba(255,0,0,0.5);
    color: #ff9090;
}

.status-info {
    background: rgba(0,234,255,0.2);
    border: 2px solid rgba(0,234,255,0.5);
    color: #90eaff;
}

/* Map Container */
.map-container {
    background: rgba(0,0,0,0.6);
    padding: 1.5rem;
    border-radius: 15px;
    margin-bottom: 2rem;
}

.map-container h3 {
    color: #00eaff;
    margin-bottom: 1rem;
}

.map-frame {
    width: 100%;
    height: 500px;
    border: 2px solid rgba(0,234,255,0.3);
    border-radius: 10px;
    background: rgba(0,0,0,0.4);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #e0f7ff;
    font-size: 1.1rem;
}

.map-frame iframe {
    width: 100%;
    height: 100%;
    border: none;
    border-radius: 8px;
}

/* Loading Animation */
.loading {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 3px solid rgba(255,255,255,.3);
    border-radius: 50%;
    border-top-color: #00eaff;
    animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

footer { 
    margin-top:2rem; 
    padding:1.2rem; 
    background: rgba(0,0,0,0.4); 
    border-top:1px solid rgba(255,255,255,0.2); 
    text-align:center; 
    font-size:0.9rem; 
    color:#cceeff; 
}
footer span.team { font-weight:600; color:#a3f0f8; }

/* Responsive */
@media (max-width: 768px) {
    .parameter-grid {
        grid-template-columns: 1fr;
    }
    
    .button-group {
        flex-direction: column;
        align-items: center;
    }
    
    .btn {
        width: 100%;
        max-width: 300px;
    }
    
    header h1 {
        font-size: 2rem;
    }
    
    .main-content {
        padding: 4rem 1rem 2rem 1rem;
    }
}
</style>
</head>
<body>

<nav>
<button id="menu-toggle">
    <div class="hamburger"><span></span><span></span><span></span></div>
    <span class="menu-text">Menu</span>
</button>
<a href="index.html">Home</a>
<a href="about.html">About</a>
<a href="why.html">Why Sharks</a>
<a href="nasa.html">NASA Data</a>
<a href="tag.html">Next-Gen Tag</a>
<a href="tracker.html">Tracker</a>
<a href="contact.html">Contact</a>
</nav>

<div class="sidebar-menu" id="sidebarMenu">
<a href="habitat.html">Shark Habitat</a>
<a href="types.html">Types of Sharks</a>
<a href="migration.html">Migration Cycle</a>
<a href="aboutus.html">About Us</a>
</div>

<div class="main-content">
<header>
<h1>🦈 Shark Tracker</h1>
<p>Real-time shark tracking and heatmap generation using NASA satellite data</p>
</header>

<div class="control-panel">
<h2>Tracking Controls</h2>
<div class="parameter-grid">
    <div class="parameter-group">
        <label for="gridRes">Grid Resolution (°)</label>
        <input type="number" id="gridRes" value="0.25" step="0.05" min="0.1" max="1.0">
    </div>
    <div class="parameter-group">
        <label for="probThreshold">Probability Threshold</label>
        <input type="number" id="probThreshold" value="0.4" step="0.05" min="0.1" max="1.0">
    </div>
    <div class="parameter-group">
        <label for="testSize">Test Size</label>
        <input type="number" id="testSize" value="0.2" step="0.05" min="0.1" max="0.5">
    </div>
    <div class="parameter-group">
        <label for="nEstimators">Random Forest Trees</label>
        <input type="number" id="nEstimators" value="200" step="50" min="50" max="500">
    </div>
</div>

<div class="button-group">
    <button id="generateDataBtn" class="btn btn-primary">
        <span id="dataBtnText">Generate Ocean Data</span>
        <span id="dataLoading" class="loading" style="display: none;"></span>
    </button>
    <button id="generateHeatmapBtn" class="btn btn-secondary" disabled>
        <span id="heatmapBtnText">Generate Heatmap</span>
        <span id="heatmapLoading" class="loading" style="display: none;"></span>
    </button>
    <button id="refreshMapsBtn" class="btn btn-primary">
        <span id="refreshBtnText">Refresh Maps</span>
        <span id="refreshLoading" class="loading" style="display: none;"></span>
    </button>
</div>
</div>

<div class="status-container">
<h3>Status</h3>
<div id="statusMessages"></div>
</div>

<div class="map-container">
<h3>Shark Probability Heatmap</h3>
<div id="mapFrame" class="map-frame">
    <div>Click "Generate Ocean Data" and then "Generate Heatmap" to view shark tracking data</div>
</div>
</div>

<footer>
&copy; 2025 Shark from Space | <span class="team">The Commit Crew</span>
</footer>
</div>

<script>
// API Base URL
const API_BASE = "http://127.0.0.1:5000";

// DOM Elements
const generateDataBtn = document.getElementById('generateDataBtn');
const generateHeatmapBtn = document.getElementById('generateHeatmapBtn');
const refreshMapsBtn = document.getElementById('refreshMapsBtn');
const statusMessages = document.getElementById('statusMessages');
const mapFrame = document.getElementById('mapFrame');

// Parameter inputs
const gridRes = document.getElementById('gridRes');
const probThreshold = document.getElementById('probThreshold');
const testSize = document.getElementById('testSize');
const nEstimators = document.getElementById('nEstimators');

// Button text elements
const dataBtnText = document.getElementById('dataBtnText');
const dataLoading = document.getElementById('dataLoading');
const heatmapBtnText = document.getElementById('heatmapBtnText');
const heatmapLoading = document.getElementById('heatmapLoading');
const refreshBtnText = document.getElementById('refreshBtnText');
const refreshLoading = document.getElementById('refreshLoading');

// Utility functions
function showStatus(message, type = 'info') {
    const statusDiv = document.createElement('div');
    statusDiv.className = `status-message status-${type}`;
    statusDiv.textContent = message;
    statusMessages.appendChild(statusDiv);
    
    // Auto-remove after 5 seconds for info messages
    if (type === 'info') {
        setTimeout(() => {
            if (statusDiv.parentNode) {
                statusDiv.parentNode.removeChild(statusDiv);
            }
        }, 5000);
    }
}

function setButtonLoading(button, textElement, loadingElement, isLoading) {
    button.disabled = isLoading;
    textElement.style.display = isLoading ? 'none' : 'inline';
    loadingElement.style.display = isLoading ? 'inline-block' : 'none';
}

function clearStatus() {
    statusMessages.innerHTML = '';
}

// API Functions
async function generateSyntheticData() {
    try {
        setButtonLoading(generateDataBtn, dataBtnText, dataLoading, true);
        clearStatus();
        showStatus('Generating synthetic ocean data...', 'info');
        
        const response = await fetch(`${API_BASE}/api/generate-synthetic-data`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            }
        });
        
        const result = await response.json();
        
        if (result.success) {
            showStatus(`✅ ${result.message}`, 'success');
            generateHeatmapBtn.disabled = false;
        } else {
            showStatus(`❌ Error: ${result.error}`, 'error');
        }
    } catch (error) {
        showStatus(`❌ Network Error: ${error.message}`, 'error');
    } finally {
        setButtonLoading(generateDataBtn, dataBtnText, dataLoading, false);
    }
}

async function generateHeatmap() {
    try {
        setButtonLoading(generateHeatmapBtn, heatmapBtnText, heatmapLoading, true);
        showStatus('Generating shark probability heatmap...', 'info');
        
        const parameters = {
            grid_res: parseFloat(gridRes.value),
            prob_threshold: parseFloat(probThreshold.value),
            test_size: parseFloat(testSize.value),
            n_est: parseInt(nEstimators.value)
        };
        
        const response = await fetch(`${API_BASE}/api/generate-heatmap`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(parameters)
        });
        
        const result = await response.json();
        
        if (result.success) {
            showStatus(`✅ ${result.message}`, 'success');
            await loadHeatmap(result.filename);
        } else {
            showStatus(`❌ Error: ${result.error}`, 'error');
        }
    } catch (error) {
        showStatus(`❌ Network Error: ${error.message}`, 'error');
    } finally {
        setButtonLoading(generateHeatmapBtn, heatmapBtnText, heatmapLoading, false);
    }
}

async function loadHeatmap(filename) {
    try {
        showStatus('Loading heatmap...', 'info');
        
        const response = await fetch(`${API_BASE}/api/heatmap/${filename}`);
        
        if (response.ok) {
            const mapUrl = `${API_BASE}/api/heatmap/${filename}`;
            mapFrame.innerHTML = `<iframe src="${mapUrl}" title="Shark Heatmap"></iframe>`;
            showStatus('✅ Heatmap loaded successfully!', 'success');
        } else {
            showStatus('❌ Failed to load heatmap', 'error');
        }
    } catch (error) {
        showStatus(`❌ Error loading heatmap: ${error.message}`, 'error');
    }
}

async function refreshMaps() {
    try {
        setButtonLoading(refreshMapsBtn, refreshBtnText, refreshLoading, true);
        showStatus('Refreshing available maps...', 'info');
        
        const response = await fetch(`${API_BASE}/api/list-heatmaps`);
        const result = await response.json();
        
        if (result.success && result.heatmaps.length > 0) {
            const latestMap = result.heatmaps[0];
            showStatus(`Found ${result.heatmaps.length} heatmap(s). Loading latest...`, 'info');
            await loadHeatmap(latestMap);
        } else {
            showStatus('No heatmaps found. Generate one first!', 'info');
        }
    } catch (error) {
        showStatus(`❌ Error refreshing maps: ${error.message}`, 'error');
    } finally {
        setButtonLoading(refreshMapsBtn, refreshBtnText, refreshLoading, false);
    }
}

// Event Listeners
generateDataBtn.addEventListener('click', generateSyntheticData);
generateHeatmapBtn.addEventListener('click', generateHeatmap);
refreshMapsBtn.addEventListener('click', refreshMaps);

// Menu functionality
const menuBtn = document.getElementById('menu-toggle');
const sidebarMenu = document.getElementById('sidebarMenu');
menuBtn.addEventListener('click', () => {
    menuBtn.classList.toggle('active');
    sidebarMenu.classList.toggle('show');
});

// Initialize
showStatus('🦈 Shark Tracker ready! Click "Generate Ocean Data" to start.', 'info');
</script>

</body>
</html>

